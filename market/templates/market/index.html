{% extends "market_base/base_with_navbar.html" %}

{% load static %}
{% load humanize %}

{% block content %}
<div class="w-full max-w-[1060px] mx-auto mt-[90px] mb-[260px]">

  {# Header: title + write button #}
  <div class="flex justify-between items-center mb-15 ml-5">
    <h2 class="text-[24px] font-semibold">중고 상품</h2>

    <a href="#"
      class="flex items-center text-[20px] font-medium text-text-main hover:text-link transition-colors">
      <img class="w-[29px] h-[29px] mr-1.5" src="{% static 'market/icons/ic-pen.svg' %}" alt="pen icon">
      <span>글쓰기</span>
    </a>
  </div>

  {# Post list grid #}
  <div class="grid grid-cols-4 gap-x-5 gap-y-[30px]">

    {% for item in items %}
    <div class="podo-card flex flex-col p-3.5 bg-gray-100">

      {# Thumbnail #}
      <img class="w-full h-[188px] rounded-[11px] object-cover mb-[19px]" src="{{ item.item_image1.url }}" alt="thumbnail">

      {# Content area #}
      <div class="flex flex-col grow mx-[11px]">

        {# Title (two-line clamp) #}
        <h2 class="font-normal text-[18px] leading-[22px] h-11 overflow-hidden text-ellipsis line-clamp-2">
          {{ item.item_title }}
        </h2>

        {# Price #}
        <div class="flex items-center h-[30px] my-[19px]">
          <span class="text-[20px] font-bold truncate">
            {{ item.item_price|intcomma }}
          </span>
        </div>

        {# Date + Address #}
        <div class="text-[15px] text-post-list-meta overflow-hidden whitespace-nowrap text-ellipsis">
          {{ item.dt_created|date:"d.m.Y" }} | {{ item.item_author.address }}
        </div>

        {# Button #}
        <a href="#" class="podo-button primary block mt-[22px] mb-4">
          View Details
        </a>

      </div>
    </div>
    {% empty %}
      <p class="col-span-4 text-center text-[20px] font-bold my-[120px]">
        판매중인 상품이 없습니다.
      </p>
    {% endfor %}

  </div>

  {# Pagination #}
  {% if is_paginated %}
  <ul class="flex justify-center items-center list-none mt-[50px] p-0">

    {% if page_obj.has_previous %}
      <li class="mr-5">
        <a href="?page=1" class="hover:underline">처음</a>
      </li>
      <li class="mr-5">
        <a href="?page={{ page_obj.previous_page_number }}" class="hover:underline">이전</a>
      </li>
    {% endif %}

    {% for num in page_obj.paginator.page_range %}
      {% if page_obj.number == num %}
        <li class="mr-5 px-[15px] py-[9px] rounded-full font-bold text-post-list-pagination bg-post-list-pagination-bg">
          {{ num }}
        </li>
      {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
        <li class="mr-5">
          <a href="?page={{ num }}" class="hover:underline">{{ num }}</a>
        </li>
      {% endif %}
    {% endfor %}

    {% if page_obj.has_next %}
      <li class="mr-5">
        <a href="?page={{ page_obj.next_page_number }}" class="hover:underline">다음</a>
      </li>
      <li>
        <a href="?page={{ page_obj.paginator.num_pages }}" class="hover:underline">마지막</a>
      </li>
    {% endif %}
  </ul>
  {% endif %}

</div>
{% endblock content %}